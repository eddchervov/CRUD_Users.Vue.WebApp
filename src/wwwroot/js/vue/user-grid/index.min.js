var userGridApp=new Vue({el:"#user-app",data:{totalCount:0,skipCount:0,takeCount:15,currentFormOperation:Vue.prototype.consts.STANDARD_OPERATION,countFormError:0,isEmptyTable:!0,users:[],selectedUserIndex:-1,lastName:"",isValidLastName:!0,errorTextLastName:"",firstName:"",isValidFirstName:!0,errorTextFirstName:"",middleName:"",isValidMiddleName:!0,errorTextMiddleName:""},methods:{getUsers:function(){var t=this;$.ajax({url:getUsersUrl,contentType:"application/json; charset=utf-8",method:"POST",data:JSON.stringify({skipCount:t.skipCount,takeCount:t.takeCount}),beforeSend:function(){edLoader.start()},success:function(e){t.totalCount=e.totalCount,t.users=e.users,t.currentFormOperation===Vue.prototype.consts.STANDARD_OPERATION&&t.endLoadingForm()},error:function(e){console.log(e),t.endLoadingForm()},complete:function(){edLoader.stop()}})},createUser:function(){var t=this;t.validationUser()&&(edLoader.start(),$.ajax({url:createUserUrl,contentType:"application/json; charset=utf-8",method:"POST",data:JSON.stringify({LastName:t.lastName,FirstName:t.firstName,MiddleName:t.middleName}),success:function(e){t.getUsers(),t.currentFormOperation=Vue.prototype.consts.STANDARD_OPERATION},error:function(e){console.log(e),edLoader.stop(),showModalDefault("Произошла ошибка добавления нового пользователя")}}))},updateUser:function(){var t=this;t.validationUser()&&(edLoader.start(),$.ajax({url:updateUserUrl,contentType:"application/json; charset=utf-8",method:"POST",data:JSON.stringify({Id:t.users[t.selectedUserIndex].id,LastName:t.lastName,FirstName:t.firstName,MiddleName:t.middleName}),success:function(e){t.getUsers(),t.currentFormOperation=Vue.prototype.consts.STANDARD_OPERATION},error:function(e){console.log(e),edLoader.stop(),showModalDefault("Произошла ошибка редактирования пользователя")}}))},validationUser:function(){return this.countFormError=0,this.lastName?this.isValidLastName=!0:(this.isValidLastName=!1,this.countFormError+=1,this.errorTextLastName=this.fieldIsRequired("Фамилия")),this.firstName?this.isValidFirstName=!0:(this.isValidFirstName=!1,this.countFormError+=1,this.errorTextFirstName=this.fieldIsRequired("Имя")),0===this.countFormError},endLoadingForm:function(){$("#load-box").addClass("d-none"),$("#user-app").removeClass("d-none")},editUserOpenForm:function(e){this.lastName=this.users[e].lastName,this.firstName=this.users[e].firstName,this.middleName=this.users[e].middleName,this.transitionToOperation(Vue.prototype.consts.EDITING_OPERATION)},transitionToOperation:function(e){void 0!==e&&(this.currentFormOperation=e)},getUserIndex:function(e){this.selectedUserIndex=e},resetAddEditForm:function(){this.lastName="",this.isValidLastName=!0,this.firstName="",this.isValidFirstName=!0,this.middleName="",this.isValidMiddleName=!0},fieldIsRequired:function(e){return"Поле "+e+" обязательно для заполнения"},getPreadvicesWrapper:function(e){},reloadEntityTable:function(e,t){this.skipCount=e,this.takeCount=t,$("#accordion").collapsible(),this.selectedUserIndex=-1,this.getUsers()}},watch:{users:function(){0<this.users.length?this.isEmptyTable=!1:this.isEmptyTable=!0},lastName:function(e,t){var s=this;s.isValidLastName=!0,s.errorTextLastName="",s.lastName.length>Vue.prototype.consts.MAX_LENGTH_LAST_NAME&&(s.lastName=t,s.isValidLastName=!1,s.errorTextLastName="Поле Фамилия должно быть строкой с максимальной длиной "+Vue.prototype.consts.MAX_LENGTH_LAST_NAME+" символов",setTimeout(function(){s.isValidLastName=!0},2500))},firstName:function(e,t){var s=this;s.isValidFirstName=!0,s.errorTextFirstName="",s.firstName.length>Vue.prototype.consts.MAX_LENGTH_FIRST_NAME&&(s.firstName=t,s.isValidFirstName=!1,s.errorTextFirstName="Поле Имя должно быть строкой с максимальной длиной "+Vue.prototype.consts.MAX_LENGTH_FIRST_NAME+" символов",setTimeout(function(){s.isValidFirstName=!0},2500))},middleName:function(e,t){var s=this;s.middleName.length>Vue.prototype.consts.MAX_LENGTH_MIDDLE_NAME&&(s.middleName=t,s.isValidMiddleName=!1,s.errorTextMiddleName="Поле Отчество должно быть строкой с максимальной длиной "+Vue.prototype.consts.MAX_LENGTH_MIDDLE_NAME+" символов",setTimeout(function(){s.isValidMiddleName=!0},2500))}},created:function(){this.getUsers()}});$.fn.collapsible=function(){$(this).addClass("ui-accordion ui-widget ui-helper-reset");var e=$(this).children("h3");e.addClass("accordion-header ui-accordion-header ui-helper-reset ui-state-active ui-accordion-icons ui-corner-all"),e.append('<span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-s">'),e.click(function(){var e=$(this),t=$(this).next();t.is(":visible")?t.slideUp("fast",function(){t.hide(),e.removeClass("ui-state-active").addClass("ui-state-default").children("span").removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e")}):t.slideDown("fast",function(){t.show(),e.removeClass("ui-state-default").addClass("ui-state-active").children("span").removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s")})})};